<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
      <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Professional Color Suite</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400&display=swap" rel="stylesheet">
  <style>
    :root {
      --border-radius: 12px;
      --transition-speed: 0.3s;
      --font-main: 'Inter', sans-serif;
      --font-mono: 'Roboto Mono', monospace;
    }

    :root[data-theme='dark'] {
      --bg-start: #0F0C29; --bg-mid: #302B63; --bg-end: #24243E;
      --surface-color: rgba(30, 30, 42, 0.85);
      --border-color: rgba(255, 255, 255, 0.1);
      --primary-text-color: #F0F0F0;
      --secondary-text-color: #A0A0A0;
      --accent-start: #ff0084; --accent-end: #33001b;
      --accent-gradient: linear-gradient(45deg, var(--accent-start), var(--accent-end));
      --accent-glow-color: rgba(255, 0, 132, 0.2);
      --shadow-color: rgba(0,0,0,0.5);
      --input-bg-color: rgba(0,0,0,0.3);
      --success-color: #00e676;
      --error-color: #ff5252;
    }

    :root[data-theme='light'] {
      --bg-start: #FDFBFB; --bg-mid: #EBEDEE; --bg-end: #FDFBFB;
      --surface-color: rgba(255, 255, 255, 0.9);
      --border-color: rgba(0, 0, 0, 0.1);
      --primary-text-color: #111;
      --secondary-text-color: #666;
      --accent-start: #d38312; --accent-end: #a83279;
      --accent-gradient: linear-gradient(45deg, var(--accent-start), var(--accent-end));
      --accent-glow-color: rgba(211, 131, 18, 0.3);
      --shadow-color: rgba(0,0,0,0.1);
      --input-bg-color: rgba(0,0,0,0.03);
      --success-color: #00c853;
      --error-color: #ff4444;
    }
    
    * { box-sizing: border-box; margin: 0; }
    body {
      font-family: var(--font-main);
      background: linear-gradient(-45deg, var(--bg-start), var(--bg-mid), var(--bg-end));
      background-size: 400% 400%; animation: gradientBG 15s ease infinite;
      color: var(--primary-text-color); display: flex; justify-content: center;
      align-items: center; min-height: 100vh; padding: 1.5rem;
    }
    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

    .container {
      width: 100%; max-width: 800px;
      background: var(--surface-color); backdrop-filter: blur(25px);
      border: 1px solid var(--border-color); border-radius: 20px;
      padding: 2rem; box-shadow: 0 20px 60px var(--shadow-color);
    }

    .main-layout { display: flex; gap: 2rem; margin-bottom: 2rem; }
    .color-preview-area { flex-basis: 200px; }
    .color-controls-area { flex: 1; }

    .color-preview {
      width: 100%; height: 200px;
      border-radius: var(--border-radius); border: 1px solid var(--border-color);
      transition: background-color var(--transition-speed);
    }
    .native-picker-wrapper { position: relative; width: 100%; height: 40px; margin-top: 1rem; border-radius: 8px; overflow: hidden; }
    .native-picker-wrapper label {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      background: var(--input-bg-color); border: 1px solid var(--border-color);
      border-radius: 8px; color: var(--secondary-text-color); cursor: pointer;
    }
    #color-picker { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
    
    #eyedropper-btn {
        width:100%; height:40px; border:none; background: var(--accent-gradient); color:white;
        border-radius:8px; cursor:pointer; display:flex; align-items:center;
        justify-content:center; gap:0.5rem; margin-top:1rem; font-weight: 500;
    }
    #eyedropper-btn:disabled { filter: grayscale(80%); cursor: not-allowed; }

    .control-group { margin-bottom: 1rem; }
    .input-with-copy { display: flex; align-items: center; gap: 0.5rem; }
    .input-with-copy input {
      flex: 1; padding: 0.75rem; border: 1px solid var(--border-color);
      border-radius: 8px; background: var(--input-bg-color); color: var(--primary-text-color);
      font-family: var(--font-mono); font-size: 1rem; outline: none; transition: border-color 0.3s;
    }
    
    .icon-btn {
        background: transparent; color: var(--secondary-text-color); border: none; padding: 0.5rem;
        border-radius: 50%; cursor: pointer; transition: all var(--transition-speed);
        display: flex; align-items: center; justify-content: center;
    }
    .icon-btn:hover { color: var(--primary-text-color); background: rgba(128,128,128,0.2); }

    .slider-group { display: flex; align-items: center; gap: 1rem; margin-top: 0.5rem; }
    .slider-group label { width: 15px; text-align: center; }
    .slider-group input[type="range"] { flex: 1; -webkit-appearance: none; appearance: none; height: 8px; border-radius: 4px; background: #ddd; outline: none; padding: 0; }
    .slider-group input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; border-radius: 50%; background: white; border: 2px solid var(--accent-start); cursor: pointer; margin-top: -5px; }
    .slider-group input[type="range"]::-moz-range-thumb { width: 14px; height: 14px; border-radius: 50%; background: white; border: 2px solid var(--accent-start); cursor: pointer; }
    .slider-group input[type="number"] { width: 60px; text-align: center; }

    #hue-slider { background: linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red); }

    .shades-tints { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
    .shades-tints h3 { text-align: center; color: var(--secondary-text-color); margin-bottom: 1rem; font-weight: 500; }
    .palette { display: grid; grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); gap: 0.5rem; }
    .palette-color {
        height: 50px; border-radius: 8px; cursor: pointer;
        transition: transform var(--transition-speed); display: flex; align-items: center; justify-content: center;
        font-size: 0.7rem; font-family: var(--font-mono); color: rgba(255,255,255,0.7);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5); border: 1px solid rgba(0,0,0,0.1);
    }
    .palette-color:hover { transform: scale(1.1); z-index: 10; }
    
    @media (max-width: 768px) {
        .main-layout { flex-direction: column; }
        .color-preview-area { flex-basis: auto; }
        .container { padding: 1.5rem; }
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="main-layout">
        <div class="color-preview-area">
            <div id="color-preview" class="color-preview"></div>
            <div class="native-picker-wrapper">
                <label for="color-picker">Choose Color</label>
                <input type="color" id="color-picker">
            </div>
             <button id="eyedropper-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m16 2-4.2 4.2c-1 1-1.4 2.5-.9 3.8s1.6 2.1 2.9 2.6l4.2 1.4c.5.2 1.2.1 1.6-.3s.5-1.1.3-1.6l-1.4-4.2c-.5-1.4-1.3-2.6-2.6-2.9L18 2"/><path d="m7 13 2.9-2.9c1-1 2.5-1.4 3.8-.9s2.1 1.6 2.6 2.9l1.4 4.2c.2.5.1 1.2-.3 1.6s-1.1.5-1.6.3l-4.2-1.4c-1.4-.5-2.6-1.3-2.9-2.6L7 13h0Z"/><path d="M12 22s-4-3-4-8 4-8 4-8"/><path d="m7 2-1.5 1.5"/></svg>
                Pick from Screen
            </button>
        </div>
        <div class="color-controls-area">
            <div class="control-group">
                <div class="input-with-copy">
                    <input type="text" id="hex-input">
                    </div>
            </div>
            <div class="control-group">
                <div class="slider-group">
                    <label for="r-slider">R</label>
                    <input type="range" id="r-slider" min="0" max="255"><input type="number" id="r-input" class="input-with-copy" min="0" max="255">
                </div>
                <div class="slider-group">
                    <label for="g-slider">G</label>
                    <input type="range" id="g-slider" min="0" max="255"><input type="number" id="g-input" class="input-with-copy" min="0" max="255">
                </div>
                <div class="slider-group">
                    <label for="b-slider">B</label>
                    <input type="range" id="b-slider" min="0" max="255"><input type="number" id="b-input" class="input-with-copy" min="0" max="255">
                </div>
            </div>
             <div class="control-group">
                <div class="slider-group">
                    <label for="h-slider">H</label>
                    <input type="range" id="h-slider" min="0" max="360"><input type="number" id="h-input" class="input-with-copy" min="0" max="360">
                </div>
                <div class="slider-group">
                    <label for="s-slider">S</label>
                    <input type="range" id="s-slider" min="0" max="100"><input type="number" id="s-input" class="input-with-copy" min="0" max="100">
                </div>
                <div class="slider-group">
                    <label for="l-slider">L</label>
                    <input type="range" id="l-slider" min="0" max="100"><input type="number" id="l-input" class="input-with-copy" min="0" max="100">
                </div>
            </div>
            <div class="control-group">
                 <div class="input-with-copy">
                     <input type="text" id="cmyk-input" readonly>
                </div>
            </div>
        </div>
    </div>
    <div class="shades-tints">
        <h3>Shades & Tints</h3>
        <div class="palette" id="shades-palette"></div>
        <div class="palette" id="tints-palette" style="margin-top:0.5rem"></div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DOM Elements ---
    const elements = {
        preview: document.getElementById('color-preview'),
        picker: document.getElementById('color-picker'),
        eyedropperBtn: document.getElementById('eyedropper-btn'),
        hexInput: document.getElementById('hex-input'),
        rSlider: document.getElementById('r-slider'), rInput: document.getElementById('r-input'),
        gSlider: document.getElementById('g-slider'), gInput: document.getElementById('g-input'),
        bSlider: document.getElementById('b-slider'), bInput: document.getElementById('b-input'),
        hSlider: document.getElementById('h-slider'), hInput: document.getElementById('h-input'),
        sSlider: document.getElementById('s-slider'), sInput: document.getElementById('s-input'),
        lSlider: document.getElementById('l-slider'), lInput: document.getElementById('l-input'),
        cmykInput: document.getElementById('cmyk-input'),
        shadesPalette: document.getElementById('shades-palette'),
        tintsPalette: document.getElementById('tints-palette'),
    };

    let currentRgb = { r: 255, g: 0, b: 132 };
    let sourceOfUpdate = null;

    const debounce = (func, delay) => {
        let timeout;
        return (...args) => {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), delay);
        };
    };

    // --- Color Conversion Formulas ---
    const rgbToHex = (r, g, b) => '#' + [r, g, b].map(x => Math.round(x).toString(16).padStart(2, '0')).join('');
    const hexToRgb = (hex) => {
        if (!/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) return null;
        let c = hex.substring(1).split('');
        if (c.length === 3) { c = [c[0], c[0], c[1], c[1], c[2], c[2]]; }
        c = '0x' + c.join('');
        return { r: (c >> 16) & 255, g: (c >> 8) & 255, b: c & 255 };
    };
    const rgbToHsl = (r, g, b) => {
        r /= 255; g /= 255; b /= 255;
        const max = Math.max(r, g, b), min = Math.min(r, g, b);
        let h=0, s=0, l = (max + min) / 2;
        if (max !== min) {
            const d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch (max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
    };
    const hslToRgb = (h, s, l) => {
        s /= 100; l /= 100;
        const k = n => (n + h / 30) % 12;
        const a = s * Math.min(l, 1 - l);
        const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, 9 - k(n), 1));
        return { r: 255 * f(0), g: 255 * f(8), b: 255 * f(4) };
    };
    const rgbToCmyk = (r, g, b) => {
        let c = 1 - (r / 255); let m = 1 - (g / 255); let y = 1 - (b / 255);
        let k = Math.min(c, m, y);
        if (k === 1) return { c: 0, m: 0, y: 0, k: 100 };
        c = (c - k) / (1 - k); m = (m - k) / (1 - k); y = (y - k) / (1 - k);
        return { c: Math.round(c*100), m: Math.round(m*100), y: Math.round(y*100), k: Math.round(k*100) };
    }

    // --- Master Update Function ---
    function updateAll(source) {
        sourceOfUpdate = source;
        
        // Step 1: Update currentRgb from the source of the change
        if (source === 'hex') {
            const newRgb = hexToRgb(elements.hexInput.value);
            if (!newRgb) { // BUG FIX: Validate HEX input
                elements.hexInput.style.borderColor = 'var(--error-color)';
                sourceOfUpdate = null;
                return;
            }
            elements.hexInput.style.borderColor = '';
            currentRgb = newRgb;
        } else if (source === 'rgb') {
            currentRgb = { r: +elements.rInput.value, g: +elements.gInput.value, b: +elements.bInput.value };
        } else if (source === 'hsl') {
            currentRgb = hslToRgb(+elements.hInput.value, +elements.sInput.value, +elements.lInput.value);
        } else if (source === 'picker') {
             currentRgb = hexToRgb(elements.picker.value);
        }

        // Step 2: Recalculate all color models from the new currentRgb
        const hex = rgbToHex(currentRgb.r, currentRgb.g, currentRgb.b);
        const hsl = rgbToHsl(currentRgb.r, currentRgb.g, currentRgb.b);
        const cmyk = rgbToCmyk(currentRgb.r, currentRgb.g, currentRgb.b);

        // Step 3: Update all UI elements if they were not the source
        if (source !== 'picker') elements.picker.value = hex;
        if (source !== 'hex') elements.hexInput.value = hex.toUpperCase();
        
        if (source !== 'rgb') {
            elements.rInput.value = Math.round(currentRgb.r); elements.rSlider.value = currentRgb.r;
            elements.gInput.value = Math.round(currentRgb.g); elements.gSlider.value = currentRgb.g;
            elements.bInput.value = Math.round(currentRgb.b); elements.bSlider.value = currentRgb.b;
        }
        if (source !== 'hsl') {
            elements.hInput.value = hsl.h; elements.hSlider.value = hsl.h;
            elements.sInput.value = hsl.s; elements.sSlider.value = hsl.s;
            elements.lInput.value = hsl.l; elements.lSlider.value = hsl.l;
        }
        
        elements.cmykInput.value = `CMYK(${cmyk.c}%, ${cmyk.m}%, ${cmyk.y}%, ${cmyk.k}%)`;
        elements.preview.style.backgroundColor = hex;

        // SMOOTHNESS FIX: Update all slider backgrounds
        elements.rSlider.style.background = `linear-gradient(to right, rgb(0, ${currentRgb.g}, ${currentRgb.b}), rgb(255, ${currentRgb.g}, ${currentRgb.b}))`;
        elements.gSlider.style.background = `linear-gradient(to right, rgb(${currentRgb.r}, 0, ${currentRgb.b}), rgb(${currentRgb.r}, 255, ${currentRgb.b}))`;
        elements.bSlider.style.background = `linear-gradient(to right, rgb(${currentRgb.r}, ${currentRgb.g}, 0), rgb(${currentRgb.r}, ${currentRgb.g}, 255))`;
        elements.sSlider.style.background = `linear-gradient(to right, hsl(${hsl.h}, 0%, ${hsl.l}%), hsl(${hsl.h}, 100%, ${hsl.l}%))`;
        elements.lSlider.style.background = `linear-gradient(to right, hsl(${hsl.h}, ${hsl.s}%, 0%), hsl(${hsl.h}, ${hsl.s}%, 50%), hsl(${hsl.h}, ${hsl.s}%, 100%))`;
        
        generatePalettes(currentRgb.r, currentRgb.g, currentRgb.b);
        sourceOfUpdate = null; // Release the lock
    }

    function generatePalettes(r, g, b) {
        elements.shadesPalette.innerHTML = '';
        elements.tintsPalette.innerHTML = '';
        for (let i = 1; i <= 10; i++) {
            const tintR = Math.round(r + (255 - r) * (i * 0.1));
            const tintG = Math.round(g + (255 - g) * (i * 0.1));
            const tintB = Math.round(b + (255 - b) * (i * 0.1));
            createPaletteColor(elements.tintsPalette, rgbToHex(tintR, tintG, tintB));

            const shadeR = Math.round(r * (1 - (i * 0.1)));
            const shadeG = Math.round(g * (1 - (i * 0.1)));
            const shadeB = Math.round(b * (1 - (i * 0.1)));
            createPaletteColor(elements.shadesPalette, rgbToHex(shadeR, shadeG, shadeB));
        }
    }
    
    function createPaletteColor(paletteEl, hex) {
        const colorDiv = document.createElement('div');
        colorDiv.className = 'palette-color';
        colorDiv.style.backgroundColor = hex;
        colorDiv.title = hex.toUpperCase();
        colorDiv.addEventListener('click', () => { updateAllFromHex(hex); });
        paletteEl.prepend(colorDiv);
    }
    
    function updateAllFromHex(hex) {
        elements.hexInput.value = hex;
        currentRgb = hexToRgb(hex);
        updateAll('hex');
    }

    // --- Event Listeners ---
    elements.picker.addEventListener('input', () => { if (sourceOfUpdate) return; updateAllFromHex(elements.picker.value); });
    // BUG FIX: Use 'input' event for real-time updates, not 'change'
    elements.hexInput.addEventListener('input', debounce(() => { if (sourceOfUpdate) return; updateAll('hex'); }, 300));
    
    ['r', 'g', 'b'].forEach(c => {
        const input = elements[`${c}Input`], slider = elements[`${c}Slider`];
        input.addEventListener('input', debounce(() => { if (sourceOfUpdate) return; slider.value = input.value; updateAll('rgb'); }, 200));
        slider.addEventListener('input', () => { if (sourceOfUpdate) return; input.value = slider.value; updateAll('rgb'); });
    });
    
    ['h', 's', 'l'].forEach(c => {
        const input = elements[`${c}Input`], slider = elements[`${c}Slider`];
        input.addEventListener('input', debounce(() => { if (sourceOfUpdate) return; slider.value = input.value; updateAll('hsl'); }, 200));
        slider.addEventListener('input', () => { if (sourceOfUpdate) return; input.value = slider.value; updateAll('hsl'); });
    });

    // --- Eye Dropper ---
    if ('EyeDropper' in window) {
        const eyeDropper = new EyeDropper();
        elements.eyedropperBtn.addEventListener('click', () => {
            eyeDropper.open().then(result => {
                updateAllFromHex(result.sRGBHex);
            }).catch(e => console.error(e));
        });
    } else {
        elements.eyedropperBtn.disabled = true;
        elements.eyedropperBtn.title = 'Your browser does not support the EyeDropper API';
    }
    
    // --- Initial Load ---
    updateAll('init');
});
</script>

</body>
</html>

