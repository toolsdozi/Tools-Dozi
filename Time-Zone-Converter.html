<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Premium World Clock & Time Converter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-gradient: linear-gradient(90deg, #FDBB2D 0%, #D4AF37 50%, #B8860B 100%);
      --background-start: #0F0C29; --background-mid: #302B63; --background-end: #24243E;
      --surface-color: rgba(26, 26, 42, 0.85); --text-color: #E0E0E0; --text-muted-color: #A0A0A0;
      --border-color: rgba(255, 215, 0, 0.2);
      --border-radius: 16px; --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: 'Inter', sans-serif; color: var(--text-color);
      background: linear-gradient(-45deg, var(--background-start), var(--background-mid), var(--background-end), var(--background-start));
      background-size: 400% 400%; animation: gradientBG 20s ease infinite;
      display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 1rem;
    }
    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    
    .container {
      width: 100%; max-width: 800px;
      background: var(--surface-color); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border-radius: var(--border-radius); box-shadow: var(--box-shadow);
      border: 1px solid var(--border-color); padding: 2.5rem;
    }
    
    h1 {
        margin-top: 0; margin-bottom: 2rem; font-weight: 700; font-size: 2rem;
        background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        text-align: center;
    }

    .main-controls { display: flex; gap: 1rem; margin-bottom: 2rem; }
    input[type="datetime-local"] {
        flex-grow: 1; padding: 0.75rem; font-size: 1rem; border: 1px solid var(--border-color);
        background-color: rgba(0,0,0,0.2); color: var(--text-color); border-radius: 8px; font-family: 'Inter', sans-serif;
    }
    input[type="datetime-local"]::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
    
    .button {
      background: var(--primary-gradient); color: #111; border: none; padding: 0.8rem 1.5rem;
      border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease;
    }
    .button:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4); }
    .button.secondary { background: none; border: 2px solid var(--text-muted-color); color: var(--text-muted-color); }
    .button.secondary:hover { background-color: var(--text-muted-color); color: #111; box-shadow: none; }

    #clocks-list { display: flex; flex-direction: column; gap: 1rem; }
    .clock-card {
        display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 1.5rem;
        background: rgba(0,0,0,0.2); padding: 1rem 1.5rem; border-radius: 12px;
        border-left: 4px solid var(--border-color);
    }
    .clock-card.local { border-left-color: #FDBB2D; }
    .clock-info .city { font-weight: 600; font-size: 1.2rem; }
    .clock-info .date { font-size: 0.9rem; color: var(--text-muted-color); }
    .clock-time { font-family: 'Roboto Mono', monospace; font-size: 2.5rem; font-weight: 700; }
    .clock-offset { font-family: 'Roboto Mono', monospace; font-size: 1rem; color: var(--text-muted-color); }

    .add-zone { margin-top: 2rem; }
    #zone-search { width: 100%; padding: 0.75rem; font-size: 1rem; border: 1px solid var(--border-color); background-color: rgba(0,0,0,0.2); color: var(--text-color); border-radius: 8px; }
    #zone-results { list-style: none; padding: 0; margin-top: 0.5rem; max-height: 150px; overflow-y: auto; }
    #zone-results li { padding: 0.75rem; cursor: pointer; border-radius: 6px; }
    #zone-results li:hover { background-color: rgba(255,255,255,0.1); }
    
    .hidden { display: none; }
    @media (max-width: 600px) {
        .clock-card { grid-template-columns: 1fr; text-align: center; }
        .clock-time { font-size: 2rem; margin: 0.5rem 0; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>World Clock & Converter</h1>
    <div class="main-controls">
        <input type="datetime-local" id="datetime-input" class="hidden">
        <button id="mode-toggle-btn" class="button secondary">Convert a Specific Time</button>
    </div>
    <div id="clocks-list"></div>
    <div class="add-zone">
        <input type="text" id="zone-search" placeholder="Add timezone (e.g., London, New York)...">
        <ul id="zone-results"></ul>
    </div>
  </div>

  <script>
    const allTimezones = Intl.supportedValuesOf('timeZone');
    const localTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    
    // Elements
    const clocksList = document.getElementById('clocks-list');
    const zoneSearch = document.getElementById('zone-search');
    const zoneResults = document.getElementById('zone-results');
    const modeToggleBtn = document.getElementById('mode-toggle-btn');
    const datetimeInput = document.getElementById('datetime-input');

    let displayedTimezones = [localTimeZone, 'America/New_York', 'Europe/London', 'Asia/Tokyo'];
    let liveUpdateInterval = null;
    let baseDate = new Date('2025-08-22T17:21:02+05:30'); // Set to user's provided time
    let mode = 'live'; // 'live' or 'specific'

    function formatTime(date, timeZone) {
        return new Intl.DateTimeFormat('en-US', {
            hour: '2-digit', minute: '2-digit', second: '2-digit',
            hour12: true, timeZone
        }).format(date);
    }
    function formatDate(date, timeZone) {
         return new Intl.DateTimeFormat('en-US', {
            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
            timeZone
        }).format(date);
    }
    function getOffset(date, timeZone1, timeZone2) {
        const offset1 = new Date(date.toLocaleString('en-US', {timeZone: timeZone1})).getTime();
        const offset2 = new Date(date.toLocaleString('en-US', {timeZone: timeZone2})).getTime();
        const diffHours = (offset2 - offset1) / (1000 * 60 * 60);
        if(diffHours === 0) return 'Local Time';
        return `${diffHours > 0 ? '+' : ''}${diffHours}h`;
    }

    function renderClocks() {
        clocksList.innerHTML = '';
        const now = mode === 'live' ? new Date() : baseDate;
        
        displayedTimezones.forEach(tz => {
            if(!tz) return;
            const card = document.createElement('div');
            card.className = 'clock-card';
            if (tz === localTimeZone) card.classList.add('local');

            const city = tz.split('/').pop().replace(/_/g, ' ');
            
            card.innerHTML = `
                <div class="clock-info">
                    <div class="city">${city}</div>
                    <div class="date">${formatDate(now, tz)}</div>
                </div>
                <div class="clock-time">${formatTime(now, tz)}</div>
                <div class="clock-offset">${getOffset(now, localTimeZone, tz)}</div>
            `;
            clocksList.appendChild(card);
        });
    }
    
    // --- Search Logic ---
    zoneSearch.addEventListener('input', () => {
        const query = zoneSearch.value.toLowerCase();
        zoneResults.innerHTML = '';
        if (!query) return;
        
        const filtered = allTimezones.filter(tz => tz.toLowerCase().includes(query)).slice(0, 5);
        filtered.forEach(tz => {
            const li = document.createElement('li');
            li.textContent = tz.replace(/_/g, ' ');
            li.addEventListener('click', () => {
                if (!displayedTimezones.includes(tz)) {
                    displayedTimezones.push(tz);
                    renderClocks();
                }
                zoneSearch.value = '';
                zoneResults.innerHTML = '';
            });
            zoneResults.appendChild(li);
        });
    });

    // --- Mode Switching Logic ---
    modeToggleBtn.addEventListener('click', () => {
        if(mode === 'live') {
            mode = 'specific';
            clearInterval(liveUpdateInterval);
            liveUpdateInterval = null;
            datetimeInput.classList.remove('hidden');
            modeToggleBtn.textContent = 'Switch to Live Clock';
            modeToggleBtn.classList.remove('secondary');
            
            // Set input to current baseDate
            const y = baseDate.getFullYear();
            const m = String(baseDate.getMonth() + 1).padStart(2, '0');
            const d = String(baseDate.getDate()).padStart(2, '0');
            const h = String(baseDate.getHours()).padStart(2, '0');
            const min = String(baseDate.getMinutes()).padStart(2, '0');
            datetimeInput.value = `${y}-${m}-${d}T${h}:${min}`;
            
            renderClocks();
        } else {
            mode = 'live';
            datetimeInput.classList.add('hidden');
            modeToggleBtn.textContent = 'Convert a Specific Time';
            modeToggleBtn.classList.add('secondary');
            startLiveClock();
        }
    });
    
    datetimeInput.addEventListener('input', () => {
        if (datetimeInput.value) {
            baseDate = new Date(datetimeInput.value);
            renderClocks();
        }
    });

    function startLiveClock() {
        if (liveUpdateInterval) clearInterval(liveUpdateInterval);
        baseDate = new Date(); // Reset to current time
        renderClocks();
        liveUpdateInterval = setInterval(renderClocks, 1000);
    }
    
    // --- Initial Setup ---
    // Make sure displayedTimezones has no duplicates
    displayedTimezones = [...new Set(displayedTimezones)]; 
    startLiveClock();
  </script>
</body>
</html>
