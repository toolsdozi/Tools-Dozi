<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Converter Tool</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

    :root {
      --primary-accent: #8e44ad;
      --secondary-accent: #3a7bd5;
      --background-color: #12121c;
      --card-bg-color: #1c1c2e;
      --text-color: #e0e0e0;
      --light-text-color: #a0a0b8;
      --border-color: #2e2e4d;
      --shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
      --border-radius: 16px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 1rem;
      box-sizing: border-box;
    }

    .container {
      background-color: var(--card-bg-color);
      border: 1px solid var(--border-color);
      padding: 2.5rem 3rem;
      border-radius: var(--border-radius);
      width: 100%;
      max-width: 750px;
      box-shadow: var(--shadow);
      text-align: center;
      transition: all 0.4s ease-in-out;
    }

    .container h1 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      background: linear-gradient(90deg, var(--primary-accent), var(--secondary-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .container .subtitle {
        color: var(--light-text-color);
        margin-bottom: 2.5rem;
    }

    /* Uploader State */
    .uploader {
      border: 2px dashed var(--border-color);
      border-radius: var(--border-radius);
      padding: 3rem;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
      position: relative;
    }
    
    .uploader.drag-over {
      border-color: var(--primary-accent);
      background-color: #25253a;
    }

    .uploader .upload-icon {
        width: 60px;
        height: 60px;
        color: var(--primary-accent);
        margin: 0 auto 1rem auto;
        transition: color 0.3s ease;
    }
    
    .uploader:hover .upload-icon {
        color: var(--secondary-accent);
    }

    .uploader .upload-text {
        color: var(--light-text-color);
        font-size: 1.1rem;
    }
    
    .uploader strong {
      color: var(--text-color);
      font-weight: 600;
    }

    #imageInput {
      display: none;
    }

    /* Converter State */
    .converter-interface {
      display: none;
      text-align: left;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    
    .converter-interface.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .preview-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
    }
    
    .preview-box {
        background: rgba(0,0,0,0.1);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .preview-box h3 {
        font-weight: 600;
        margin-top: 0;
        margin-bottom: 1rem;
        font-size: 1.1rem;
        color: var(--text-color);
    }
    
    .preview-box img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin-bottom: 1rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .image-details {
        text-align: left;
        width: 100%;
        font-size: 0.9rem;
    }

    .image-details p {
        margin: 0.5rem 0;
        color: var(--light-text-color);
        word-break: break-all;
    }
    
    .image-details p span {
        font-weight: 500;
        color: var(--text-color);
    }

    .controls-section {
        background: rgba(0,0,0,0.1);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
        border-radius: 12px;
    }

    .control-row {
        display: grid;
        grid-template-columns: 100px 1fr 50px;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .control-row label {
        font-weight: 500;
        text-align: left;
    }
    
    select, input[type="range"] {
      flex: 1;
    }

    select, .action-btn {
      width: 100%;
      padding: 0.85rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Poppins', sans-serif;
      background-color: #25253a;
      color: var(--text-color);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    select:focus, input[type="range"]:focus {
        border-color: var(--primary-accent);
        outline: none;
        box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.2);
    }

    .action-btn {
        grid-column: 1 / -1;
        border: none;
        font-weight: 600;
        background: linear-gradient(90deg, var(--primary-accent), var(--secondary-accent));
        background-size: 200%;
        text-decoration: none;
        text-align: center;
    }
    
    .action-btn:hover {
        background-position: right;
    }
    
    .action-btn.secondary {
        background: var(--border-color);
    }
    .action-btn.secondary:hover {
        background: #3a3a5a;
    }
    
    .control-row#quality-control.hidden {
        display: none;
    }

    #quality-value {
        font-weight: 600;
        text-align: right;
        color: var(--text-color);
    }

    .loader {
        border: 4px solid rgba(255,255,255,0.2);
        border-radius: 50%;
        border-top: 4px solid var(--primary-accent);
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Image Converter Tool</h1>
    <p class="subtitle">An advanced tool to convert images with a professional touch.</p>

    <div class="uploader" id="uploader">
      <svg class="upload-icon" xmlns="http://www.w.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
      </svg>
      <div class="upload-text">
        <strong>Drop your image here</strong><br/>or click to browse
      </div>
      <input type="file" id="imageInput" accept="image/*" />
    </div>

    <div class="converter-interface" id="converterInterface">
      <div class="preview-section">
        <div class="preview-box" id="originalPreview"></div>
        <div class="preview-box" id="convertedPreview"></div>
      </div>
      <div class="controls-section">
        <div class="control-row">
          <label for="formatSelect">Convert to:</label>
          <select id="formatSelect" style="grid-column: 2 / 4;">
            <option value="png">PNG</option>
            <option value="jpeg">JPG</option>
            <option value="webp">WebP</option>
            <option value="gif">GIF</option>
          </select>
        </div>
        <div class="control-row hidden" id="quality-control">
          <label for="qualitySlider">Quality:</label>
          <input type="range" id="qualitySlider" min="0" max="100" value="92">
          <span id="quality-value">92</span>
        </div>
        <div class="control-row">
          <button onclick="convertImage()" id="convertBtn" class="action-btn">Convert Image</button>
        </div>
        <div class="control-row">
          <button onclick="resetApp()" class="action-btn secondary">Use Another Image</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const uploader = document.getElementById('uploader');
    const imageInput = document.getElementById('imageInput');
    const converterInterface = document.getElementById('converterInterface');
    const originalPreview = document.getElementById('originalPreview');
    const convertedPreview = document.getElementById('convertedPreview');
    const convertBtn = document.getElementById('convertBtn');
    const formatSelect = document.getElementById('formatSelect');
    const qualityControl = document.getElementById('quality-control');
    const qualitySlider = document.getElementById('qualitySlider');
    const qualityValue = document.getElementById('quality-value');

    let originalFile;
    let originalImageElement = new Image();

    uploader.addEventListener('click', () => imageInput.click());
    imageInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
    
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => uploader.addEventListener(eventName, preventDefaults, false));
    ['dragenter', 'dragover'].forEach(eventName => uploader.addEventListener(eventName, () => uploader.classList.add('drag-over'), false));
    ['dragleave', 'drop'].forEach(eventName => uploader.addEventListener(eventName, () => uploader.classList.remove('drag-over'), false));
    uploader.addEventListener('drop', (e) => {
        preventDefaults(e);
        handleFile(e.dataTransfer.files[0]);
    }, false);

    formatSelect.addEventListener('change', () => qualityControl.classList.toggle('hidden', !['jpeg', 'webp'].includes(formatSelect.value)));
    qualitySlider.addEventListener('input', () => qualityValue.textContent = qualitySlider.value);
    
    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    function handleFile(file) {
      if (!file || !file.type.startsWith('image/')) {
        alert("Please select a valid image file.");
        return;
      }
      originalFile = file;
      
      const reader = new FileReader();
      reader.onload = (e) => {
        originalImageElement.src = e.target.result;
        originalImageElement.onload = () => {
            uploader.style.display = 'none';
            converterInterface.style.display = 'block';
            setTimeout(() => converterInterface.classList.add('visible'), 10);
            displayFileInfo(originalPreview, "Original", originalImageElement, originalFile);
            convertedPreview.innerHTML = `<h3>Converted</h3><p style="color:var(--light-text-color);">Ready to be converted.</p>`;
        }
      };
      reader.readAsDataURL(file);
    }
    
    function displayFileInfo(container, title, imgElement, file, downloadInfo = null) {
        let downloadButtonHTML = '';
        if (downloadInfo) {
            downloadButtonHTML = `<a href="${downloadInfo.url}" download="${downloadInfo.name}" class="action-btn" style="margin-top: 1rem;">Download Image</a>`;
        }
        container.innerHTML = `
            <h3>${title}</h3>
            <img src="${imgElement.src}" alt="${title}">
            <div class="image-details">
                <p>Filename: <span>${file.name}</span></p>
                <p>Dimensions: <span>${imgElement.naturalWidth} x ${imgElement.naturalHeight} px</span></p>
                <p>Size: <span>${formatFileSize(file.size)}</span></p>
            </div>
            ${downloadButtonHTML}`;
    }
    
    function formatFileSize(bytes, decimals = 2) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    }

    function convertImage() {
      if (!originalFile) return;
      convertedPreview.innerHTML = `<h3>Converted</h3><div class="loader"></div><p style="margin-top: 1rem; color: var(--light-text-color);">Converting...</p>`;
      convertBtn.disabled = true;
      convertBtn.style.opacity = '0.7';
      
      const format = formatSelect.value;
      const quality = parseInt(qualitySlider.value, 10) / 100;
      const canvas = document.createElement("canvas");
      canvas.width = originalImageElement.naturalWidth;
      canvas.height = originalImageElement.naturalHeight;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(originalImageElement, 0, 0);

      setTimeout(() => {
        canvas.toBlob((blob) => {
            const convertedUrl = URL.createObjectURL(blob);
            const convertedImageElement = new Image();
            convertedImageElement.src = convertedUrl;

            convertedImageElement.onload = () => {
                const baseName = originalFile.name.split('.').slice(0, -1).join('.');
                const convertedFileName = `${baseName}-converted.${format}`;
                const convertedFile = new File([blob], convertedFileName, { type: `image/${format}` });
                const downloadInfo = { url: convertedUrl, name: convertedFileName };
                displayFileInfo(convertedPreview, "Converted", convertedImageElement, convertedFile, downloadInfo);
            };

            convertBtn.disabled = false;
            convertBtn.style.opacity = '1';
        }, `image/${format}`, ['jpeg', 'webp'].includes(format) ? quality : undefined);
      }, 50);
    }
    
    function resetApp() {
        converterInterface.classList.remove('visible');
        setTimeout(() => {
            originalFile = null;
            imageInput.value = ''; // Important to allow re-uploading the same file
            uploader.style.display = 'block';
            converterInterface.style.display = 'none';
            originalPreview.innerHTML = '';
            convertedPreview.innerHTML = '';
        }, 400); // Wait for CSS transition
    }
    formatSelect.dispatchEvent(new Event('change'));
  </script>
</body>
</html>
