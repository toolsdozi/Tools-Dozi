<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real-time URL Encoder / Decoder</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400&display=swap" rel="stylesheet">
  <style>
    :root {
      --border-radius: 12px;
      --transition-speed: 0.3s;
      --font-main: 'Inter', sans-serif;
      --font-mono: 'Roboto Mono', monospace;
    }

    :root[data-theme='dark'] {
      --bg-start: #0F0C29; --bg-mid: #302B63; --bg-end: #24243E;
      --surface-color: rgba(30, 30, 42, 0.75);
      --border-color: rgba(94, 9, 215, 0.3);
      --primary-text-color: #F0F0F0;
      --secondary-text-color: #A0A0A0;
      --accent-start: #4e54c8; --accent-end: #8f94fb;
      --accent-gradient: linear-gradient(45deg, var(--accent-start), var(--accent-end));
      --accent-glow-color: rgba(143, 148, 251, 0.3);
      --shadow-color: rgba(0,0,0,0.5);
      --input-bg-color: rgba(0,0,0,0.3);
      --success-color: #00e676;
    }

    :root[data-theme='light'] {
      --bg-start: #FDFBFB; --bg-mid: #EBEDEE; --bg-end: #FDFBFB;
      --surface-color: rgba(255, 255, 255, 0.8);
      --border-color: rgba(0, 0, 0, 0.1);
      --primary-text-color: #111;
      --secondary-text-color: #666;
      --accent-start: #007bff; --accent-end: #0056b3;
      --accent-gradient: linear-gradient(45deg, var(--accent-start), var(--accent-end));
      --accent-glow-color: rgba(0, 123, 255, 0.3);
      --shadow-color: rgba(0,0,0,0.1);
      --input-bg-color: rgba(0,0,0,0.03);
      --success-color: #00c853;
    }

    * { box-sizing: border-box; margin: 0; }

    body {
      font-family: var(--font-main);
      background: linear-gradient(-45deg, var(--bg-start), var(--bg-mid), var(--bg-end));
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: var(--primary-text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

    .container {
      width: 100%; max-width: 1200px;
      background: var(--surface-color); backdrop-filter: blur(25px);
      border: 1px solid var(--border-color); border-radius: var(--border-radius);
      padding: 2rem; box-shadow: 0 20px 60px var(--shadow-color);
    }
    
    .header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 2rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color);
    }
    
    h1 {
      font-size: 2rem;
      background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }

    .panels-container { display: flex; gap: 1.5rem; align-items: center; }
    .panel { flex: 1; display: flex; flex-direction: column; }
    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
    .panel-header h2 { font-size: 1.1rem; color: var(--secondary-text-color); }
    .actions { display: flex; gap: 0.5rem; }

    .text-area {
      width: 100%; min-height: 300px; padding: 1rem;
      border: 1px solid var(--border-color); border-radius: 8px;
      background: var(--input-bg-color); color: var(--primary-text-color);
      font-size: 1rem; font-family: var(--font-mono);
      outline: none; transition: all var(--transition-speed); resize: vertical;
    }
    .text-area:focus { border-color: var(--accent-start); box-shadow: 0 0 15px var(--accent-glow-color); }

    .icon-btn {
      background: transparent; color: var(--secondary-text-color);
      border: none; padding: 0.5rem; border-radius: 50%;
      cursor: pointer; transition: all var(--transition-speed);
      display: flex; align-items: center; justify-content: center;
    }
    .icon-btn:hover { color: var(--primary-text-color); background: rgba(128,128,128,0.2); transform: scale(1.1); }
    .icon-btn svg { width: 18px; height: 18px; }

    .swap-btn { border-radius: 8px; border: 1px solid var(--border-color); padding: 0.75rem; }
    
    .options-bar {
      margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);
      display: flex; justify-content: center; align-items: center;
    }
    
    .encoding-mode { display: flex; gap: 1rem; background: var(--input-bg-color); padding: 0.5rem; border-radius: 8px; }
    .encoding-mode label {
      padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;
      transition: all var(--transition-speed); color: var(--secondary-text-color);
    }
    .encoding-mode input { display: none; }
    .encoding-mode input:checked + label {
      background: var(--accent-gradient); color: white;
      box-shadow: 0 2px 8px var(--accent-glow-color);
    }
    
    @media (max-width: 900px) {
      .panels-container { flex-direction: column; }
      .swap-btn { transform: rotate(90deg); }
      .header { flex-direction: column; align-items: flex-start; gap: 1rem; }
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
        <h1>URL Utility</h1>
        <button class="icon-btn" id="theme-toggle" title="Switch Theme">
            <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 010 1.06l-1.591 1.59a.75.75 0 11-1.06-1.06l1.59-1.59a.75.75 0 011.06 0zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.894 17.894a.75.75 0 01-1.06 0l-1.59-1.591a.75.75 0 111.06-1.06l1.59 1.59a.75.75 0 010 1.061zM12 18a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM5.106 17.894a.75.75 0 010-1.06l1.59-1.59a.75.75 0 011.06 1.06l-1.59 1.59a.75.75 0 01-1.06 0zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM6.106 6.106a.75.75 0 011.06 0l1.591 1.59a.75.75 0 01-1.06 1.06l-1.59-1.59a.75.75 0 010-1.06z"/></svg>
            <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="display:none;"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 004.463-.949a.75.75 0 01.819.162l.805.805a.75.75 0 01-.316 1.065A11.25 11.25 0 0112 21a11.25 11.25 0 01-11.25-11.25 11.25 11.25 0 019.282-11.242l.805.805z" clip-rule="evenodd" /></svg>
        </button>
    </div>

    <div class="panels-container">
      <div class="panel">
        <div class="panel-header">
          <h2>Decoded</h2>
          <div class="actions">
            <button class="icon-btn" id="copy-decoded-btn" title="Copy Decoded"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3.5A1.5 1.5 0 018.5 2h3.879a1.5 1.5 0 011.06.44l3.122 3.121A1.5 1.5 0 0117 6.621V16.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 017 16.5v-13z" /><path d="M5 6.5A1.5 1.5 0 016.5 5h3a.5.5 0 000-1h-3A2.5 2.5 0 004 6.5v10A2.5 2.5 0 006.5 19h7a2.5 2.5 0 002.5-2.5h-1A1.5 1.5 0 0113.5 18h-7A1.5 1.5 0 015 16.5v-10z" /></svg></button>
            <button class="icon-btn" id="clear-decoded-btn" title="Clear Decoded"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-1.157.26-2.116.86-2.847 1.691a.75.75 0 001.06 1.06c.64-.64 1.44-1.121 2.387-1.3V12a.75.75 0 001.5 0V5.643c.947.179 1.747.66 2.387 1.3a.75.75 0 001.06-1.06A4.238 4.238 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 12.5a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" clip-rule="evenodd" /><path d="M3 10a.75.75 0 01.75-.75h12.5a.75.75 0 010 1.5H3.75A.75.75 0 013 10z" /></svg></button>
          </div>
        </div>
        <textarea id="decoded-input" class="text-area" placeholder="Type or paste a URL here..."></textarea>
      </div>

      <button class="icon-btn swap-btn" id="swap-btn" title="Swap Panels">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 2.5a.75.75 0 01.75.75v10.55l1.95-2.1a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 111.1-1.02l1.95 2.1V3.25A.75.75 0 0110 2.5z" clip-rule="evenodd" /><path d="M5.22 6.22a.75.75 0 011.06 0L8 7.94l1.72-1.72a.75.75 0 111.06 1.06L9.06 10l1.72 1.72a.75.75 0 11-1.06 1.06L8 11.06l-1.72 1.72a.75.75 0 01-1.06-1.06L6.94 10 5.22 8.28a.75.75 0 010-1.06z" /></svg>
      </button>

      <div class="panel">
        <div class="panel-header">
          <h2>Encoded</h2>
          <div class="actions">
            <button class="icon-btn" id="copy-encoded-btn" title="Copy Encoded"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3.5A1.5 1.5 0 018.5 2h3.879a1.5 1.5 0 011.06.44l3.122 3.121A1.5 1.5 0 0117 6.621V16.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 017 16.5v-13z" /><path d="M5 6.5A1.5 1.5 0 016.5 5h3a.5.5 0 000-1h-3A2.5 2.5 0 004 6.5v10A2.5 2.5 0 006.5 19h7a2.5 2.5 0 002.5-2.5h-1A1.5 1.5 0 0113.5 18h-7A1.5 1.5 0 015 16.5v-10z" /></svg></button>
            <button class="icon-btn" id="clear-encoded-btn" title="Clear Encoded"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-1.157.26-2.116.86-2.847 1.691a.75.75 0 001.06 1.06c.64-.64 1.44-1.121 2.387-1.3V12a.75.75 0 001.5 0V5.643c.947.179 1.747.66 2.387 1.3a.75.75 0 001.06-1.06A4.238 4.238 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 12.5a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" clip-rule="evenodd" /><path d="M3 10a.75.75 0 01.75-.75h12.5a.75.75 0 010 1.5H3.75A.75.75 0 013 10z" /></svg></button>
          </div>
        </div>
        <textarea id="encoded-input" class="text-area" placeholder="Encoded URL appears here..."></textarea>
      </div>
    </div>
    
    <div class="options-bar">
      <div class="encoding-mode" id="encoding-mode-group">
        <input type="radio" id="mode-component" name="encoding-mode" value="component" checked>
        <label for="mode-component">Encode URI Component</label>
        
        <input type="radio" id="mode-full" name="encoding-mode" value="full">
        <label for="mode-full">Encode URI</label>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const decodedInput = document.getElementById('decoded-input');
    const encodedInput = document.getElementById('encoded-input');
    const swapBtn = document.getElementById('swap-btn');
    const themeToggle = document.getElementById('theme-toggle');
    const encodingModeGroup = document.getElementById('encoding-mode-group');

    let currentMode = 'component'; // 'component' or 'full'

    const handleEncode = () => {
        const text = decodedInput.value;
        if (!text) {
            encodedInput.value = '';
            return;
        }
        try {
            const encoded = (currentMode === 'component')
                ? encodeURIComponent(text)
                : encodeURI(text);
            encodedInput.value = encoded;
            encodedInput.style.borderColor = '';
        } catch (e) {
            encodedInput.value = 'Error during encoding.';
            encodedInput.style.borderColor = 'red';
        }
    };

    const handleDecode = () => {
        const encoded = encodedInput.value.trim();
        if (!encoded) {
            decodedInput.value = '';
            return;
        }
        try {
            // BUG FIX: Removed .replace(/\+/g, ' ') as it's not standard for decodeURIComponent
            // and can lead to incorrect decoding of strings that intentionally contain a '+' sign.
            const decoded = decodeURIComponent(encoded);
            decodedInput.value = decoded;
            decodedInput.style.borderColor = '';
        } catch (e) {
            decodedInput.value = 'Invalid encoded string.';
            decodedInput.style.borderColor = 'red';
        }
    };
    
    const debounce = (func, delay) => {
        let timeout;
        return (...args) => {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), delay);
        };
    };

    decodedInput.addEventListener('input', debounce(handleEncode, 200));
    encodedInput.addEventListener('input', debounce(handleDecode, 200));

    encodingModeGroup.addEventListener('change', (e) => {
        if (e.target.name === 'encoding-mode') {
            currentMode = e.target.value;
            handleEncode();
        }
    });

    swapBtn.addEventListener('click', () => {
        const temp = decodedInput.value;
        decodedInput.value = encodedInput.value;
        encodedInput.value = temp;
        handleEncode();
    });

    const setupButtonActions = (type) => {
        const inputEl = document.getElementById(`${type}-input`);
        document.getElementById(`copy-${type}-btn`).addEventListener('click', () => {
            if (!inputEl.value) return;
            navigator.clipboard.writeText(inputEl.value).then(() => {
                console.log(`${type} copied!`);
            });
        });
        document.getElementById(`clear-${type}-btn`).addEventListener('click', () => {
            inputEl.value = '';
            inputEl.dispatchEvent(new Event('input', { bubbles: true }));
        });
    };
    setupButtonActions('decoded');
    setupButtonActions('encoded');

    function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        document.getElementById('theme-icon-sun').style.display = theme === 'dark' ? 'none' : 'block';
        document.getElementById('theme-icon-moon').style.display = theme === 'dark' ? 'block' : 'none';
    }
    themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        setTheme(currentTheme === 'dark' ? 'light' : 'dark');
    });
    const savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme);
});
</script>

</body>
</html>
