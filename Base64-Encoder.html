<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
      <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real-time Base64 Encoder/Decoder</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400&display=swap" rel="stylesheet">
  <style>
    :root {
      --border-radius: 12px;
      --transition-speed: 0.3s;
      --font-main: 'Inter', sans-serif;
      --font-mono: 'Roboto Mono', monospace;
    }

    :root[data-theme='dark'] {
      --bg-start: #0F0C29; --bg-mid: #302B63; --bg-end: #24243E;
      --surface-color: rgba(30, 30, 42, 0.75);
      --border-color: rgba(255, 215, 0, 0.2);
      --primary-text-color: #F0F0F0;
      --secondary-text-color: #A0A0A0;
      --gold-start: #FDBB2D; --gold-end: #D4AF37;
      --gold-gradient: linear-gradient(45deg, var(--gold-start), var(--gold-end));
      --gold-glow-color: rgba(253, 187, 45, 0.3);
      --shadow-color: rgba(0,0,0,0.5);
      --input-bg-color: rgba(0,0,0,0.3);
      --success-color: #00e676;
      --error-color: #e74c3c;
    }

    :root[data-theme='light'] {
      --bg-start: #FDFBFB; --bg-mid: #EBEDEE; --bg-end: #FDFBFB;
      --surface-color: rgba(255, 255, 255, 0.8);
      --border-color: rgba(0, 0, 0, 0.1);
      --primary-text-color: #111;
      --secondary-text-color: #666;
      --gold-start: #1d2b64; --gold-end: #3d52a0;
      --gold-gradient: linear-gradient(45deg, #1d2b64, #3d52a0);
      --gold-glow-color: rgba(61, 82, 160, 0.3);
      --shadow-color: rgba(0,0,0,0.1);
      --input-bg-color: rgba(0,0,0,0.03);
      --success-color: #00c853;
      --error-color: #c0392b;
    }

    * { box-sizing: border-box; margin: 0; }

    body {
      font-family: var(--font-main);
      background: linear-gradient(-45deg, var(--bg-start), var(--bg-mid), var(--bg-end));
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: var(--primary-text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

    .container {
      width: 100%; max-width: 1200px;
      background: var(--surface-color); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
      border: 1px solid var(--border-color); border-radius: var(--border-radius);
      padding: 2rem; box-shadow: 0 20px 60px var(--shadow-color);
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    h1 {
      font-size: 2rem;
      background: var(--gold-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }

    .panels-container {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }

    .panel { flex: 1; display: flex; flex-direction: column; }
    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
    .panel-header h2 { font-size: 1.1rem; color: var(--secondary-text-color); }
    .actions { display: flex; gap: 0.5rem; }

    .text-area {
      width: 100%;
      min-height: 300px;
      padding: 1rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: var(--input-bg-color);
      color: var(--primary-text-color);
      font-size: 1rem;
      font-family: var(--font-mono);
      outline: none;
      transition: all var(--transition-speed);
      resize: vertical;
    }
    .text-area:focus { border-color: var(--gold-start); box-shadow: 0 0 15px var(--gold-glow-color); }
    .text-area.drag-over { border: 2px dashed var(--gold-start); box-shadow: 0 0 25px var(--gold-glow-color); }
    
    .error-message { color: var(--error-color); font-size: 0.9rem; margin-top: 0.5rem; min-height: 20px; text-align: left; }

    .icon-btn {
      background: transparent; color: var(--secondary-text-color);
      border: none; padding: 0.5rem; border-radius: 50%;
      cursor: pointer; transition: all var(--transition-speed);
      display: flex; align-items: center; justify-content: center;
    }
    .icon-btn:hover { color: var(--primary-text-color); background: rgba(128,128,128,0.2); transform: scale(1.1); }
    .icon-btn svg { width: 18px; height: 18px; }

    .swap-btn { border-radius: 8px; border: 1px solid var(--border-color); padding: 0.75rem; }
    
    .options-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border-color);
    }
    .checkbox-group { display: flex; align-items: center; gap: 0.5rem; cursor: pointer; user-select: none; }
    .checkbox-group input { display: none; }
    .checkbox-group .checkmark { width: 20px; height: 20px; border: 1px solid var(--border-color); border-radius: 4px; background: rgba(0,0,0,0.1); transition: all var(--transition-speed); position: relative; }
    .checkbox-group .checkmark::after { content: 'âœ”'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); color: white; transition: transform var(--transition-speed) ease-out; }
    .checkbox-group input:checked + .checkmark { background: var(--gold-gradient); border-color: transparent; }
    .checkbox-group input:checked + .checkmark::after { transform: translate(-50%, -50%) scale(1); }
    
    #ad-container { margin-top: 1.5rem; display: flex; justify-content: center; align-items: center; }

    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(200%);
      padding: 1rem 1.5rem;
      border-radius: 8px;
      font-weight: 500;
      color: #111;
      background: var(--success-color);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: transform 0.4s ease-in-out;
      z-index: 1000;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }

    @media (max-width: 900px) {
      .panels-container { flex-direction: column; }
      .swap-btn { transform: rotate(90deg); }
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
        <h1>Base64 Utility</h1>
        <button class="icon-btn" id="theme-toggle" title="Switch Theme" aria-label="Switch Theme">
            <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 010 1.06l-1.591 1.59a.75.75 0 11-1.06-1.06l1.59-1.59a.75.75 0 011.06 0zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.894 17.894a.75.75 0 01-1.06 0l-1.59-1.591a.75.75 0 111.06-1.06l1.59 1.59a.75.75 0 010 1.061zM12 18a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM5.106 17.894a.75.75 0 010-1.06l1.59-1.59a.75.75 0 011.06 1.06l-1.59 1.59a.75.75 0 01-1.06 0zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM6.106 6.106a.75.75 0 011.06 0l1.591 1.59a.75.75 0 01-1.06 1.06l-1.59-1.59a.75.75 0 010-1.06z"/></svg>
            <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" style="display:none;"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 004.463-.949a.75.75 0 01.819.162l.805.805a.75.75 0 01-.316 1.065A11.25 11.25 0 0112 21a11.25 11.25 0 01-11.25-11.25 11.25 11.25 0 019.282-11.242l.805.805z" clip-rule="evenodd" /></svg>
        </button>
    </div>

    <div class="panels-container">
      <div class="panel">
        <div class="panel-header">
          <h2 id="text-panel-header">Text</h2>
          <div class="actions">
            <button class="icon-btn" id="copy-text-btn" title="Copy Text" aria-label="Copy Text"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3.5A1.5 1.5 0 018.5 2h3.879a1.5 1.5 0 011.06.44l3.122 3.121A1.5 1.5 0 0117 6.621V16.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 017 16.5v-13z" /><path d="M5 6.5A1.5 1.5 0 016.5 5h3a.5.5 0 000-1h-3A2.5 2.5 0 004 6.5v10A2.5 2.5 0 006.5 19h7a2.5 2.5 0 002.5-2.5h-1A1.5 1.5 0 0113.5 18h-7A1.5 1.5 0 015 16.5v-10z" /></svg></button>
            <button class="icon-btn" id="clear-text-btn" title="Clear Text" aria-label="Clear Text"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-1.157.26-2.116.86-2.847 1.691a.75.75 0 001.06 1.06c.64-.64 1.44-1.121 2.387-1.3V12a.75.75 0 001.5 0V5.643c.947.179 1.747.66 2.387 1.3a.75.75 0 001.06-1.06A4.238 4.238 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 12.5a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" clip-rule="evenodd" /><path d="M3 10a.75.75 0 01.75-.75h12.5a.75.75 0 010 1.5H3.75A.75.75 0 013 10z" /></svg></button>
          </div>
        </div>
        <textarea id="text-input" class="text-area" placeholder="Type text, or drop a file here..." aria-labelledby="text-panel-header"></textarea>
        <div class="error-message" id="text-error"></div>
      </div>

      <button class="icon-btn swap-btn" id="swap-btn" title="Swap Panels" aria-label="Swap Panels">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M15.904 4.032a.75.75 0 01.143 1.054l-2.5 3.5a.75.75 0 01-1.196-.858l1.29-1.805H5.75a.75.75 0 000 1.5h8.891l-1.29 1.805a.75.75 0 11-1.196.858l2.5 3.5a.75.75 0 01-.143 1.054A.75.75 0 0116.25 16h-6.5a.75.75 0 010-1.5h5.44l-1.95-2.73a.75.75 0 11.91-1.18l3.25 4.55a.75.75 0 010 .86l-3.25 4.55a.75.75 0 11-.91-1.18l1.95-2.73H9.75a.75.75 0 010-1.5h.001z" clip-rule="evenodd" transform="rotate(90 10 10)"/></svg>
      </button>

      <div class="panel">
        <div class="panel-header">
          <h2 id="b64-panel-header">Base64</h2>
          <div class="actions">
            <button class="icon-btn" id="copy-b64-btn" title="Copy Base64" aria-label="Copy Base64"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3.5A1.5 1.5 0 018.5 2h3.879a1.5 1.5 0 011.06.44l3.122 3.121A1.5 1.5 0 0117 6.621V16.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 017 16.5v-13z" /><path d="M5 6.5A1.5 1.5 0 016.5 5h3a.5.5 0 000-1h-3A2.5 2.5 0 004 6.5v10A2.5 2.5 0 006.5 19h7a2.5 2.5 0 002.5-2.5h-1A1.5 1.5 0 0113.5 18h-7A1.5 1.5 0 015 16.5v-10z" /></svg></button>
            <button class="icon-btn" id="clear-b64-btn" title="Clear Base64" aria-label="Clear Base64"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 006 3.75v.443c-1.157.26-2.116.86-2.847 1.691a.75.75 0 001.06 1.06c.64-.64 1.44-1.121 2.387-1.3V12a.75.75 0 001.5 0V5.643c.947.179 1.747.66 2.387 1.3a.75.75 0 001.06-1.06A4.238 4.238 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 12.5a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" clip-rule="evenodd" /><path d="M3 10a.75.75 0 01.75-.75h12.5a.75.75 0 010 1.5H3.75A.75.75 0 013 10z" /></svg></button>
          </div>
        </div>
        <textarea id="b64-input" class="text-area" placeholder="Base64 output appears here..." aria-labelledby="b64-panel-header"></textarea>
        <div class="error-message" id="b64-error"></div>
      </div>
    </div>
    
    <div class="options-bar">
      <label for="data-url-check" class="checkbox-group">
        <input type="checkbox" id="data-url-check">
        <span class="checkmark"></span>
        Include Data URL Prefix (for files)
      </label>
    </div>
    <div id="ad-container">
        </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const textInput = document.getElementById('text-input');
    const b64Input = document.getElementById('b64-input');
    const swapBtn = document.getElementById('swap-btn');
    const dataUrlCheck = document.getElementById('data-url-check');
    const themeToggle = document.getElementById('theme-toggle');
    const textError = document.getElementById('text-error');
    const b64Error = document.getElementById('b64-error');

    const textEncoder = new TextEncoder();
    const textDecoder = new TextDecoder();

    const bytesToBase64 = (bytes) => {
        const binString = Array.from(bytes, (byte) => String.fromCodePoint(byte)).join("");
        return btoa(binString);
    };
    
    const base64ToBytes = (base64) => {
        const binString = atob(base64);
        return Uint8Array.from(binString, (m) => m.codePointAt(0));
    };

    const handleTextToB64 = () => {
        const text = textInput.value;
        b64Error.textContent = '';
        if (!text) {
            b64Input.value = '';
            return;
        }
        try {
            const bytes = textEncoder.encode(text);
            b64Input.value = bytesToBase64(bytes);
        } catch (e) {
            b64Input.value = '';
            b64Error.textContent = 'Error during encoding.';
        }
    };

    const handleB64ToText = () => {
        let base64 = b64Input.value.trim();
        textError.textContent = '';
        if (!base64) {
            textInput.value = '';
            return;
        }
        try {
            // Handle data URLs
            if (base64.startsWith('data:')) {
                base64 = base64.substring(base64.indexOf(',') + 1);
            }
            const bytes = base64ToBytes(base64);
            textInput.value = textDecoder.decode(bytes);
        } catch (e) {
            textInput.value = '';
            textError.textContent = 'Invalid Base64 string.';
        }
    };

    const debounce = (func, delay) => {
        let timeout;
        return (...args) => {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), delay);
        };
    };

    textInput.addEventListener('input', debounce(handleTextToB64, 200));
    b64Input.addEventListener('input', debounce(handleB64ToText, 200));

    swapBtn.addEventListener('click', () => {
        const temp = textInput.value;
        textInput.value = b64Input.value;
        b64Input.value = temp;
        handleTextToB64();
        handleB64ToText();
    });

    const setupButtonActions = (type) => {
        const inputEl = document.getElementById(`${type}-input`);
        document.getElementById(`copy-${type}-btn`).addEventListener('click', () => {
            if (!inputEl.value) return;
            navigator.clipboard.writeText(inputEl.value);
            showToast(`${type === 'text' ? 'Text' : 'Base64'} copied!`);
        });
        document.getElementById(`clear-${type}-btn`).addEventListener('click', () => {
            inputEl.value = '';
            inputEl.dispatchEvent(new Event('input', { bubbles: true }));
        });
    };
    setupButtonActions('text');
    setupButtonActions('b64');

    textInput.addEventListener('dragover', (e) => {
        e.preventDefault();
        textInput.classList.add('drag-over');
    });
    textInput.addEventListener('dragleave', () => textInput.classList.remove('drag-over'));
    textInput.addEventListener('drop', (e) => {
        e.preventDefault();
        textInput.classList.remove('drag-over');
        const file = e.dataTransfer.files[0];
        if (file) {
            const reader = new FileReader();
            if (file.type.startsWith('text/')) {
                reader.onload = (readEvent) => {
                    textInput.value = readEvent.target.result;
                    handleTextToB64();
                };
                reader.readAsText(file);
            } else {
                reader.onload = (readEvent) => {
                    let base64 = readEvent.target.result;
                    textInput.value = `File: ${file.name}\nType: ${file.type}\nSize: ${file.size} bytes`;
                    if (!dataUrlCheck.checked) {
                        base64 = base64.substring(base64.indexOf(',') + 1);
                    }
                    b64Input.value = base64;
                };
                reader.readAsDataURL(file);
            }
        }
    });

    function showToast(message) {
        const existingToast = document.querySelector('.toast');
        if (existingToast) existingToast.remove();
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.body.appendChild(toast);
        setTimeout(() => toast.classList.add('show'), 10);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 500);
        }, 2000);
    }

    function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        document.getElementById('theme-icon-sun').style.display = theme === 'dark' ? 'none' : 'block';
        document.getElementById('theme-icon-moon').style.display = theme === 'dark' ? 'block' : 'none';
    }
    themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        setTheme(currentTheme === 'dark' ? 'light' : 'dark');
    });
    const savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme);

    // Add Ad Script dynamically
    const adContainer = document.getElementById('ad-container');
    const adScriptOptions = document.createElement('script');
    adScriptOptions.type = 'text/javascript';
    adScriptOptions.innerHTML = `
        atOptions = {
            'key' : 'aaa10b05ab727c7a2a4556625b4dcc37',
            'format' : 'iframe',
            'height' : 50,
            'width' : 320,
            'params' : {}
        };
    `;
    const adScriptInvoke = document.createElement('script');
    adScriptInvoke.type = 'text/javascript';
    adScriptInvoke.src = '//www.highperformanceformat.com/aaa10b05ab727c7a2a4556625b4dcc37/invoke.js';
    
    adContainer.appendChild(adScriptOptions);
    adContainer.appendChild(adScriptInvoke);
});
</script>

</body>
</html>
